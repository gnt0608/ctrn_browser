"use strict";const o=require("electron"),n=require("path"),c=require("fs"),u=require("electron-store");process.env.ROOT=n.join(__dirname,"..");process.env.DIST=n.join(process.env.ROOT,"dist-electron");process.env.VITE_PUBLIC=process.env.VITE_DEV_SERVER_URL?n.join(process.env.ROOT,"public"):n.join(process.env.ROOT,".output/public");process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";let t;const f=n.join(process.env.DIST,"preload.js");function E(){o.ipcMain.handle("getFolder",I),o.ipcMain.handle("dialog:openFile",R),o.ipcMain.handle("walkTree",T),t=new o.BrowserWindow({webPreferences:{preload:f,nodeIntegrationInWorker:!0,contextIsolation:!0,nodeIntegration:!0,webSecurity:!1}}),process.env.VITE_DEV_SERVER_URL?(t.loadURL(process.env.VITE_DEV_SERVER_URL),t.webContents.openDevTools()):t.loadFile(n.join(process.env.VITE_PUBLIC,"index.html"))}const a=new u({name:"folder"});async function R(){const{canceled:r,filePaths:e}=await o.dialog.showOpenDialog({title:"Open File",properties:["openDirectory"]});if(!r)return a.set("folder",e[0]),e[0]}function I(){return a.get("folder","")}function T(r,e){return p(e)}function p(r){let e=[],d=c.readdirSync(r);for(let i of d){var s=n.join(r,i);let l=c.statSync(s);l.isDirectory()?e.push({name:i,type:"directory",child:p(s)}):l.isFile()&&e.push({name:i,type:"file"})}return e}o.app.whenReady().then(E);
